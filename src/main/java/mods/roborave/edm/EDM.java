package mods.roborave.edm;
import java.util.Arrays;

import mods.roborave.edm.common.CommonProxy;
import mods.roborave.edm.config.Config;
import mods.roborave.edm.helper.LogHandler;
import mods.roborave.edm.helper.VersionChecker;
import mods.roborave.edm.init.Blocks;
import mods.roborave.edm.lib.Strings;
import mods.roborave.edm.server.command.EDMCommand;
import mods.roborave.edm.tick.TickHandler;
import net.minecraft.creativetab.CreativeTabs;
import cpw.mods.fml.common.Mod;
import cpw.mods.fml.common.Mod.EventHandler;
import cpw.mods.fml.common.ModMetadata;
import cpw.mods.fml.common.SidedProxy;
import cpw.mods.fml.common.event.FMLInitializationEvent;
import cpw.mods.fml.common.event.FMLPostInitializationEvent;
import cpw.mods.fml.common.event.FMLPreInitializationEvent;
import cpw.mods.fml.common.event.FMLServerStartingEvent;

@Mod(modid = Strings.MODID, name = Strings.name, version = Strings.version)

public class EDM
{
	
	
	@SidedProxy
	(
			clientSide="mods.roborave.edm.client.ClientProxy",
			serverSide="mods.roborave.edm.common.CommonProxy"
	)
	public static CommonProxy proxy;
	
	public String acutalMCversion= "1.7.2";
	
	private Blocks blocks;
	
	public static CreativeTabs tabEDMBlock;
	
	public static CreativeTabs tabEDMItems;
	
	private static Config VersionConfig;
	
	public LogHandler logger = new LogHandler();
	
	@IMod(Modid = "EDM", id = 1, name = "EDM")
	
	public Strings library = new Strings();
	
	public static TickHandler tickHandler = new TickHandler();
	
	@Mod.Metadata(Strings.MODID)
	public ModMetadata meta;

	
	@Mod.Instance(Strings.MODID)
	public static EDM Instance;
	
	 
	@Mod.EventHandler
	public void PreInit(FMLPreInitializationEvent event)
	{
		meta = event.getModMetadata();
		meta.autogenerated = false;
		meta.credits = "(C) Roborave, 2013-2014";
		meta.authorList = Arrays.asList("Roborave");
		meta.name = Strings.name;
		meta.version = Strings.version;
		meta.modId="Extra_Diamonds_Mod";
		
		proxy.PreInit();
		VersionChecker.registerMod(meta);
		
		EDM.setVersionConfig(new Config(event.getSuggestedConfigurationFile())); 
		EDM.getVersionConfig().load();
		EDM.getVersionConfig().save();
		
		EDM.Instance.getLogger().info(IMod.class.getMethods().toString());
		
    }
	
	@EventHandler
	public void Init(FMLInitializationEvent event)
	{
	
	proxy.loadMod();
	
	if(EDM.getVersionConfig().checkForUpdates()) 
	{
		VersionChecker.startVersionCheck();
	}

	proxy.registerTickers();
	
	}
	
	@EventHandler
	public void PostInit(FMLPostInitializationEvent event)
	{
		
	}
	
	@EventHandler
	public void serverStarting(FMLServerStartingEvent evt)
	{
		 evt.registerServerCommand(new EDMCommand(evt.getServer()));
	}
	
	public Blocks getBlocks() 
	{
		return blocks;
	}
	public void setBlocks(Blocks blocks) 
	{
		this.blocks = blocks;
	}

	public LogHandler getLogger() 
	{
		return logger;
	}

	public void setLogger(LogHandler logger) 
	{
		this.logger = logger;
	}

	public Strings getLibrary() 
	{
		return library;
	}

	public void setLibrary(Strings library) 
	{
		this.library = library;
	}

	public static Config getVersionConfig() {
		return VersionConfig;
	}

	public static void setVersionConfig(Config versionConfig) 
	{
		VersionConfig = versionConfig;
	}

	
	
}
